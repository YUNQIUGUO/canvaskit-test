<!DOCTYPE html>
<title>CanvasKit (Skia via Web Assembly)</title>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
  canvas, img {
    border: 1px dashed #AAA;
    width: 300px;
    height: 300px;
  }

</style>

<h2>Demo Trial</h2>

<h2>Draw simple texts</h2>

<canvas id=api1_c width=300 height=300></canvas>

<script type="text/javascript" src="/node_modules/canvaskit/bin/canvaskit.js"></script>

<script type="text/javascript" charset="utf-8">

  var CanvasKit = null;

  var robotoData = null;
  var notoserifData = null;

  var bonesImageData = null;
  var mandrillData = null;
  CanvasKitInit({
    locateFile: (file) => '/node_modules/canvaskit/bin/'+file,
  }).ready().then((CK) => {
    CanvasKit = CK;
    DrawingExample(CanvasKit, robotoData);
    PathExample(CanvasKit);
    InkExample(CanvasKit);

    CanvasAPI1(CanvasKit);
    CanvasAPI2(CanvasKit);
    CanvasAPI3(CanvasKit);
    CanvasAPI4(CanvasKit);
    CanvasAPI5(CanvasKit);
    CanvasAPI6(CanvasKit);
    CanvasAPI7(CanvasKit);
    CanvasAPI8(CanvasKit);

    VertexAPI1(CanvasKit);
    VertexAPI2(CanvasKit, bonesImageData);

    GradiantAPI1(CanvasKit);

    TextShapingAPI1(CanvasKit, notoserifData);
    TextShapingAPI2(CanvasKit, notoserifData);
    TextOnPathAPI1(CanvasKit);

    SurfaceAPI1(CanvasKit);

    AtlasAPI1(CanvasKit, mandrillData);
  });

let robotoData = null;
fetch('https://storage.googleapis.com/skia-cdn/google-web-fonts/Roboto-Regular.ttf').then((resp) => {
  resp.arrayBuffer().then((buffer) => {
    robotoData = buffer;
    requestAnimationFrame(drawFrame);
  });
}); // fetch font

const surface = CanvasKit.MakeCanvasSurface(canvas.id);
if (!surface) {
  throw 'Could not make surface';
}
const skcanvas = surface.getCanvas();

const font = new CanvasKit.SkFont(null, 18);
const fontPaint = new CanvasKit.SkPaint();
fontPaint.setStyle(CanvasKit.PaintStyle.Fill);
fontPaint.setAntiAlias(true);

skcanvas.drawText(`Fetching Font data...`, 5, 450, fontPaint, font);
surface.flush();

const context = CanvasKit.currentContext();

let paragraph = null;
let X = 250;
let Y = 250;
const str = 'Our group project is to accomplish a RBI via a new approach on remote browser isolation system with the help of chromium engine.'

function drawFrame() {
  if (robotoData &&!paragraph) {
    const fontMgr = CanvasKit.SkFontMgr.FromData([robotoData]);

    const paraStyle = new CanvasKit.ParagraphStyle({
      textStyle: {
        color: CanvasKit.BLACK,
        fontFamilies: ['Roboto'],
        fontSize: 20,
      },
      textAlign: CanvasKit.TextAlign.Left,
      maxLines: 7,
      ellipsis: '...',
    });

    const builder = CanvasKit.ParagraphBuilder.Make(paraStyle, fontMgr);
    builder.addText(str);
    paragraph = builder.build();
  }
  if (!paragraph) {
    requestAnimationFrame(drawFrame);
    return;
  }

  CanvasKit.setCurrentContext(context);
  skcanvas.clear(CanvasKit.WHITE);

  let wrapTo = 350;
  paragraph.layout(wrapTo);
  skcanvas.drawParagraph(paragraph, 0, 0);

  
  surface.flush();
  requestAnimationFrame(drawFrame);

}
</script>